#include "Gaussian_bayes.h"
#include "nrf_delay.h"

const float32_t theta [NB_OF_CLASSES * VECTOR_DIMENSION] = {
0.22349771857261658, 9.724137635203078e-05, 0.05794239044189453, 0.2234005481004715, 2.2064436052460223e-05, 0.0717725083231926, 0.04940839856863022, 0.07180359959602356, -0.09594587981700897, 2.764413595199585, 0.005163746420294046, 4.5258307456970215, 1.2393107414245605, 1.2387735843658447, 3.113513469696045, 3.8581089973449707, -3.5997469240101054e-05, 7.433085556840524e-05, -1.7564968857186614e-06, 152.8551025390625, 5.893033261372693e-08, 3.883744739141548e-07, 11.623065948486328, 154.88232421875, 879.8799438476562, 493.0195007324219, 1009.8856201171875, 0.1583849936723709, 6.841213325969875e-05, 0.04622270166873932, 0.15831659734249115, 2.7914845435184077e-10, 0.05734671279788017, 0.03945201262831688, 0.0573747381567955, 0.04649467021226883, 2.8375003337860107, 0.0033638097811490297, 4.0633697509765625, 1.2434186935424805, 1.2428112030029297, 2.770775556564331, 3.453667402267456, 8.948776667239144e-06, 3.4828652133001015e-05, 2.5140468551398953e-07, 132.11402893066406, 4.2261053323500164e-08, 3.880177530390938e-07, 12.734463691711426, 190.05931091308594, 106.50861358642578, 162.95762634277344, 195.03530883789062, 0.24272207915782928, 0.003205066081136465, 0.09104782342910767, 0.23951703310012817, 0.09104782342910767, 0.10150718688964844, 0.08497199416160583, 0.04485415294766426, 0.4565841555595398, 2.8977761268615723, 0.0020189571660012007, 2.856996774673462, 0.49278613924980164, 1.1149406433105469, 2.3901052474975586, 2.6656243801116943, 4.288446871214546e-05, 1.2076226994395256e-05, 7.938797352835536e-07, 211.58648681640625, 5.455738261161969e-08, 7.291543511200871e-07, 21.83448028564453, 487.36749267578125, 254.01461791992188, 454.28692626953125, 520.6703491210938, 1.4097940921783447, 0.0002640929014887661, 0.2089657187461853, 1.409529447555542, -3.3950280339922756e-05, 0.2910454273223877, 0.1671842336654663, 0.2911873161792755, 0.19698795676231384, 5.389214992523193, 0.08481959253549576, 8.436802864074707, 1.3935812711715698, 1.3929020166397095, 4.844083786010742, 6.74875020980835, 0.0048896633088588715, 0.03885757550597191, 0.009203980676829815, 250.06900024414062, 9.719997251522727e-07, 2.8599915822269395e-06, 6.1510419845581055, 56.359352111816406, 2740.0546875, 922.3093872070312, 2891.240234375, 0.1008613109588623, 3.130863478872925e-05, 0.022590015083551407, 0.10083003342151642, -1.1461619847663584e-10, 0.028869470581412315, 0.01889563910663128, 0.028883570805191994, -0.2163597196340561, 3.261552095413208, 0.0008350040297955275, 5.337940692901611, 1.278725504875183, 1.2781010866165161, 3.491338014602661, 4.463664531707764, -5.165850780031178e-06, 2.2888023067935137e-06, -4.230018291195847e-08, 80.56307220458984, 9.33409083359038e-09, 4.2961787016793096e-08, 10.138771057128906, 123.18511199951172, 942.485595703125, 912.1229248046875, 1311.9285888671875, 1.526867389678955, 0.007029528729617596, 0.3293011784553528, 1.519837737083435, 0.3293011784553528, 0.4116005301475525, 0.28860190510749817, 0.24700403213500977, 1.4845906496047974, 5.47808313369751, 0.06105412542819977, 5.292278289794922, 0.750191867351532, 1.249984622001648, 3.7100412845611572, 4.637722492218018, 0.022464510053396225, 0.020505813881754875, 0.016257809475064278, 290.4239196777344, 1.1147401437483495e-06, 1.0119471880898345e-05, 18.739797592163086, 381.98895263671875, 445.3241882324219, 704.6907958984375, 833.6527709960938, 0.4578876495361328, 0.00016596514615230262, 0.11063699424266815, 0.45772191882133484, 4.930843715555966e-07, 0.1382969170808792, 0.09382400661706924, 0.1383643001317978, -0.004688161425292492, 2.927065849304199, 0.01920199580490589, 4.887371063232422, 1.250787377357483, 1.2501779794692993, 3.3122737407684326, 4.142865180969238, -9.920742741087452e-06, 0.0010922388173639774, -2.6603820515447296e-06, 217.3490447998047, 2.1907665370690665e-07, 7.982666261341365e-07, 6.778306484222412, 62.33938217163086, 2994.25634765625, 738.68896484375, 3085.14306640625, 0.04702821746468544, 1.762127249094192e-05, 0.012236918322741985, 0.047010570764541626, 2.2941262778353178e-10, 0.015127076767385006, 0.010455974377691746, 0.015134462155401707, -0.027188770473003387, 2.761850357055664, 0.00023027740826364607, 4.506351947784424, 1.2372009754180908, 1.2365970611572266, 3.110191822052002, 3.8481862545013428, -9.457166072479595e-08, 1.4891649868786772e-07, -2.0583765247828012e-10, 51.77994155883789, 2.608146809635059e-09, 1.3773946427875217e-08, 11.146674156188965, 157.63417053222656, 674.126708984375, 918.464599609375, 1139.827880859375, 0.4966447353363037, 0.0057012056931853294, 0.1737372726202011, 0.4909436106681824, 0.1737372726202011, 0.19558146595954895, 0.16124850511550903, 0.08976595103740692, 0.5774141550064087, 3.09769344329834, 0.008093655109405518, 3.0845937728881836, 0.5170581340789795, 1.1259044408798218, 2.5403807163238525, 2.8616421222686768, 0.0004317073035053909, 0.00020820600911974907, 3.277876749052666e-05, 286.77056884765625, 2.0718225357541087e-07, 2.6731456728157355e-06, 22.041419982910156, 494.06414794921875, 322.83892822265625, 688.1898193359375, 760.4402465820312, 3.163614273071289, 0.0003356406232342124, 0.40466147661209106, 3.163278102874756, -1.992583565879613e-05, 0.668081521987915, 0.286251038312912, 0.6684077978134155, 0.05691024288535118, 7.605108261108398, 0.44750040769577026, 11.066917419433594, 1.6521013975143433, 1.6512950658798218, 4.739770412445068, 7.827612400054932, 0.01689188927412033, 1.5292034149169922, 0.15454959869384766, 115.1017074584961, 5.109204721520655e-06, 1.969562981685158e-05, 6.576066493988037, 57.36849594116211, 3261.2763671875, 425.60040283203125, 3289.00927734375, 0.14559482038021088, 3.3580916351638734e-05, 0.0233311727643013, 0.14556120336055756, 1.353716694296736e-09, 0.03178268298506737, 0.01896323822438717, 0.031798217445611954, 0.13469287753105164, 5.002906322479248, 0.0010152070317417383, 7.679951190948486, 1.3634717464447021, 1.3628062009811401, 4.573299884796143, 6.2368268966674805, 4.509137852437561e-06, 5.291238267091103e-06, 9.45042657463091e-08, 80.92772674560547, 1.1170674163452077e-08, 3.393555658703917e-08, 5.595223903656006, 43.914222717285156, 2120.919677734375, 1367.0516357421875, 2525.2509765625, 3.373771905899048, 0.008824566379189491, 0.6362077593803406, 3.364945650100708, 0.6362077593803406, 0.9448098540306091, 0.49285373091697693, 0.6987771391868591, 1.7051907777786255, 5.128378868103027, 0.4890737235546112, 6.8571953773498535, 1.098731279373169, 1.485347867012024, 3.5753421783447266, 5.311298370361328, 0.5842083096504211, 1.2306867837905884, 2.4586827754974365, -18.505586624145508, 7.13028612153721e-06, 5.617859642370604e-05, 12.534887313842773, 175.12855529785156, 229.4994354248047, 310.8028564453125, 386.40948486328125, 1.5651909112930298, 0.0001247507316293195, 0.11145204305648804, 1.5650653839111328, 1.0757595191535074e-05, 0.19269753992557526, 0.08355756849050522, 0.19279170036315918, -0.08583749085664749, 21.46601676940918, 0.037489958107471466, 18.758686065673828, 1.7281278371810913, 1.7272857427597046, 8.13779354095459, 14.069430351257324, -0.000621599203441292, 0.030977332964539528, -0.0011144555173814297, 185.84033203125, 4.322191955452581e-07, 1.0002202088799095e-06, 3.724379777908325, 20.481586456298828, 3022.68017578125, 755.5733032226562, 3116.883056640625, 0.08217046409845352, 2.269993638037704e-05, 0.013726850971579552, 0.08214779198169708, -1.6177348349799558e-10, 0.017773158848285675, 0.01147471833974123, 0.01778183877468109, 0.3067271411418915, 4.206345558166504, 0.00031799799762666225, 7.154346466064453, 1.2953543663024902, 1.2947217226028442, 4.609981536865234, 5.97613525390625, 1.8642095938048442e-06, 4.504012451889139e-07, 1.1454218906692404e-08, 55.853599548339844, 3.5755838290185693e-09, 1.4397436132185248e-08, 9.404982566833496, 118.51836395263672, 847.7429809570312, 1026.0936279296875, 1332.2679443359375, 1.728697657585144, 0.003795094322413206, 0.17502254247665405, 1.724901795387268, 0.17502254247665405, 0.2725156247615814, 0.14368176460266113, 0.20880389213562012, 4.092939376831055, 23.982759475708008, 0.0441533699631691, 12.056380271911621, 1.191015362739563, 1.555517554283142, 6.359865665435791, 9.900328636169434, 0.03831549361348152, 0.047340381890535355, 0.06271275877952576, 237.06060791015625, 6.278564796957653e-07, 3.5031869174417807e-06, 13.96735668182373, 245.57763671875, 347.9053955078125, 572.772705078125, 670.3179931640625, 0.7639840841293335, 0.00011877460201503709, 0.09903240203857422, 0.7638652920722961, -1.0027157259173691e-05, 0.14023269712924957, 0.0795806497335434, 0.14030107855796814, 0.07395868003368378, 6.710142135620117, 0.02266073226928711, 9.049727439880371, 1.3869144916534424, 1.386238932609558, 5.10526704788208, 7.235179424285889, 0.0008997577242553234, 0.009654800407588482, 0.0038859271444380283, 189.69857788085938, 2.590872156815749e-07, 9.10179664970201e-07, 6.370687961578369, 55.207313537597656, 2536.112548828125, 1007.3853149414062, 2745.298583984375, 0.07831305265426636, 2.2244748834054917e-05, 0.016013532876968384, 0.07829080522060394, -4.843565826195828e-11, 0.020455772057175636, 0.013460855931043625, 0.02046576887369156, 0.022059356793761253, 3.4817874431610107, 0.00043780356645584106, 5.663137912750244, 1.2730157375335693, 1.2723939418792725, 3.71799635887146, 4.754136562347412, -1.2810269511831507e-09, 1.009494781101239e-06, -2.45753439820362e-09, 62.59909439086914, 4.930198471697622e-09, 2.2597431481585772e-08, 8.609926223754883, 97.1408920288086, 559.909423828125, 652.2737426757812, 860.894287109375, 0.8401469588279724, 0.0038658869452774525, 0.1553901731967926, 0.8362812399864197, 0.1553901731967926, 0.19831910729408264, 0.1364847868680954, 0.12086453288793564, 1.7547938823699951, 8.2378568649292, 0.018912436440587044, 5.817465305328369, 0.7344261407852173, 1.249526858329773, 3.984299659729004, 5.086062908172607, 0.009874016046524048, 0.011698161251842976, 0.016266796737909317, 248.74208068847656, 3.106108579231659e-07, 3.0680932923132787e-06, 20.719013214111328, 450.9808349609375, 464.98077392578125, 833.7692260742188, 956.37158203125, 0.33652010560035706, 0.00011752596765290946, 0.07932256162166595, 0.33640256524086, 1.886965492303716e-06, 0.09932897239923477, 0.06723406165838242, 0.09937727451324463, 0.003059817012399435, 2.969256639480591, 0.009895295836031437, 5.005065441131592, 1.25288987159729, 1.2522798776626587, 3.3853070735931396, 4.24094295501709, 2.904408120230073e-06, 0.0002952170907519758, -1.1455835391416258e-07, 182.7888946533203, 1.1289823476090532e-07, 3.896975044881401e-07, 8.134303092956543, 91.52246856689453, 3086.742919921875, 1170.5252685546875, 3302.925537109375, 0.04853041470050812, 2.0496878278208897e-05, 0.012942097149789333, 0.04850989952683449, 3.748204871478755e-11, 0.0160518828779459, 0.011021332815289497, 0.016059715300798416, -0.005337645299732685, 2.749110460281372, 0.00025866072974167764, 4.407581806182861, 1.2410155534744263, 1.240409255027771, 3.022434949874878, 3.751223564147949, -2.888116767962856e-08, 1.86730048312711e-07, -6.367973509613378e-11, 53.97004699707031, 2.9105009513585856e-09, 1.869555354971908e-08, 13.546083450317383, 217.5669708251953, 430.6033020019531, 607.12646484375, 744.837890625, 0.3699565827846527, 0.003956614527851343, 0.1246720552444458, 0.36599987745285034, 0.1246720552444458, 0.14047251641750336, 0.1156855970621109, 0.06471716612577438, 0.6027986407279968, 3.166710615158081, 0.00420379638671875, 3.197878837585449, 0.5190598368644714, 1.1267154216766357, 2.632239818572998, 2.96685528755188, 0.0001720340660540387, 5.916388181503862e-05, 7.743946298433002e-06, 248.1564178466797, 1.0714467890693413e-07, 1.3611399936053203e-06, 22.26816749572754, 501.111572265625, 566.8709106445312, 1031.9346923828125, 1177.7462158203125, 2.907179832458496, 0.00041063493699766695, 0.3607955276966095, 2.906768798828125, -4.7976522182580084e-05, 0.5253040790557861, 0.2812559902667999, 0.5255605578422546, 0.3084891438484192, 7.266689777374268, 0.2774110734462738, 10.349441528320312, 1.4571330547332764, 1.4564223289489746, 5.528470993041992, 8.061671257019043, 0.04585505649447441, 0.571953535079956, 0.4289444386959076, 211.28768920898438, 3.196358875356964e-06, 1.0678066246327944e-05, 5.44077205657959, 41.15808868408203, 2832.790771484375, 624.6464233398438, 2901.158203125, 0.20065778493881226, 4.636920493794605e-05, 0.03458555042743683, 0.20061135292053223, -6.03672278831624e-10, 0.04599320515990257, 0.02833898738026619, 0.04601568728685379, -0.07684222608804703, 4.2791056632995605, 0.002122148172929883, 7.083456516265869, 1.3306599855422974, 1.3300100564956665, 4.3612961769104, 5.802084922790527, -8.352532859134953e-06, 1.9502293071127497e-05, -2.9036658588665887e-07, 106.77970123291016, 2.3909908719588202e-08, 1.274586765021013e-07, 14.032492637634277, 244.82891845703125, 1045.63671875, 1038.2139892578125, 1473.690673828125, 3.1425042152404785, 0.010460122488439083, 0.5667592287063599, 3.1320462226867676, 0.5667592287063599, 0.7428926229476929, 0.48301899433135986, 0.4802902638912201, 1.903421401977539, 7.843196868896484, 0.23188114166259766, 6.5074944496154785, 0.8477669358253479, 1.3109914064407349, 4.223860263824463, 5.542428970336914, 0.2167252004146576, 0.4396708905696869, 0.8701963424682617, 153.22337341308594, 3.935670974897221e-06, 3.2159990951186046e-05, 16.780033111572266, 323.78118896484375, 253.93113708496094, 523.7879028320312, 582.1387939453125, 0.5247730016708374, 0.00014654065307695419, 0.09908615797758102, 0.5246263146400452, 2.13210824995258e-07, 0.12852619588375092, 0.08260829001665115, 0.12858887016773224, 0.0007656621746718884, 3.80745792388916, 0.017694849520921707, 6.2205281257629395, 1.291912317276001, 1.2912830114364624, 4.007798194885254, 5.188409805297852, -1.7077340999094304e-06, 0.0025249263271689415, 1.3127062629791908e-05, 200.14749145507812, 2.044318136995571e-07, 7.988824677340745e-07, 7.4231858253479, 71.97586059570312, 2991.175048828125, 825.9696655273438, 3105.218994140625, 0.048233307898044586, 1.9513490769895725e-05, 0.01180307287722826, 0.04821375757455826, -3.407790716281056e-10, 0.014736018143594265, 0.010022832080721855, 0.014743216335773468, 0.04789188504219055, 2.923522710800171, 0.00021889321214985102, 4.806696891784668, 1.2491559982299805, 1.2485462427139282, 3.2635338306427, 4.078756809234619, 1.3965244249902753e-07, 1.4595657660265715e-07, 3.259028047430945e-10, 50.23713684082031, 2.47064058100932e-09, 1.3663524534024418e-08, 11.749410629272461, 172.42202758789062, 634.8688354492188, 862.9946899414062, 1073.3277587890625, 0.5706687569618225, 0.003938964102417231, 0.15562257170677185, 0.5667298436164856, 0.15562257170677185, 0.1817636340856552, 0.14194604754447937, 0.0935325026512146, 1.061873197555542, 4.550955295562744, 0.00986086018383503, 3.941134214401245, 0.591576337814331, 1.1626895666122437, 3.0857326984405518, 3.596616744995117, 0.0019328385824337602, 0.0015438675181940198, 0.0013434704160317779, 265.4398498535156, 2.1261193694499525e-07, 2.3636587229702855e-06, 21.540769577026367, 478.26226806640625, 354.9068298339844, 726.091796875, 808.4276123046875, 4.506494998931885, 0.00021826138254255056, 0.2977616488933563, 4.506277084350586, -4.7649384214309976e-05, 0.586338996887207, 0.19697421789169312, 0.586625337600708, -0.024203835055232048, 19.72377586364746, 0.34922468662261963, 22.971546173095703, 1.969744086265564, 1.968782901763916, 7.686795234680176, 15.187495231628418, 0.005085463635623455, 2.5592939853668213, 0.42303475737571716, 127.06716918945312, 3.8994758142507635e-06, 1.1098316463176161e-05, 4.428936958312988, 26.62400245666504, 2969.205810546875, 778.9074096679688, 3071.261474609375, 0.33195191621780396, 3.8212299841688946e-05, 0.03502782806754112, 0.33191367983818054, 7.859737860549387e-10, 0.05092538893222809, 0.027778757736086845, 0.05095028132200241, 0.576374351978302, 9.483901023864746, 0.002615764969959855, 11.992145538330078, 1.4549328088760376, 1.4542231559753418, 6.526332378387451, 9.499865531921387, 8.202603203244507e-05, 6.755458889529109e-05, 9.575608601153363e-06, 104.96005249023438, 2.8981709476738615e-08, 1.3486210548308009e-07, 10.688386917114258, 149.1924591064453, 1011.3568115234375, 1007.4296264648438, 1427.970947265625, 5.134491443634033, 0.006245647557079792, 0.468002587556839, 5.128243923187256, 0.468002587556839, 0.8292086124420166, 0.3389699459075928, 0.6843085289001465, 3.3292605876922607, 16.456331253051758, 0.47657567262649536, 15.21203899383545, 1.461695671081543, 1.771410346031189, 6.195037364959717, 11.011153221130371, 1.1284908056259155, 4.0356926918029785, 16.211462020874023, 53.04877853393555, 6.133847364253597e-06, 3.483908949419856e-05, 9.720194816589355, 115.207275390625, 270.32904052734375, 541.3555297851562, 605.3187866210938};

const float32_t sigma [NB_OF_CLASSES * VECTOR_DIMENSION] = {
0.0008884846916686743, 0.00041739387715265683, 0.0004226720430694346, 0.0008879075627107173, 0.00041794992031617004, 0.0004253636803611531, 0.000421609896048432, 0.0004253711545886123, 0.010183305204546451, 0.029615821041798593, 0.00041754743842835215, 0.18159955712471007, 0.0005908296603508293, 0.0005904092991756275, 0.07432505460891724, 0.1252834198108673, 0.0004173826555997477, 0.00041738142615951754, 0.00041738125327918314, 15.36795774074707, 0.0004173812500000441, 0.00041738125000329013, 1.171920567475891, 712.4462791976563, 3172.627614646875, 865.774587303125, 1425.6415306625, 0.001228099530263245, 0.00041738674371215187, 0.00046852124941386284, 0.0012278804948352277, 0.00041738125000001074, 0.0004892632146863266, 0.0004592260935084429, 0.0004893335222647525, 0.10341942282829285, 0.33346921178016664, 0.00041839896888694203, 0.4823170599571228, 0.0022995345803707838, 0.0022976958003625273, 0.12489589276227951, 0.28246459337387086, 0.00041738581375603976, 0.00041738178967874615, 0.00041738125669925184, 192.7185570296875, 0.0004173812500003161, 0.0004173812500428044, 6.766225963555908, 5274.26115956875, 690.1109520492188, 988.5618797835938, 1539.1646019515624, 0.0010417945028081536, 0.00041987117387241743, 0.00043036099176850404, 0.0010353124976888299, 0.00043036099176850404, 0.00043334686196492986, 0.0004296396069464041, 0.00042444380741533824, 0.021752353482580186, 0.17556637498054503, 0.0004174386438940818, 0.0749870759478569, 0.0010292396924257278, 0.0005366839555705897, 0.046349908881521226, 0.06250211941514015, 0.00041738159916528003, 0.0004173812639895413, 0.000417381250297944, 24.75172010036621, 0.00041738125000006333, 0.0004173812500151194, 0.20776870819244384, 227.617360740625, 717.4685570296875, 683.9500023421875, 1203.8076683578124, 0.01719589690182209, 0.0004174405427484888, 0.00043463871915326455, 0.01719222004029751, 0.00041753334396053707, 0.00044686871259789915, 0.00043133132620885737, 0.00044689758905468044, 0.004441772778218985, 0.13899674984130858, 0.0004273667405784014, 0.636734634362793, 0.0006399849385986104, 0.0006397744160410016, 0.19224438043746947, 0.39670911403808595, 0.0004200131903332309, 0.00043255090312475805, 0.00042924026055578144, 8.431560188256835, 0.0004173812500023306, 0.0004173812501916467, 2.063290267907715, 704.0676781234375, 2211.078298240625, 474.4431969222656, 1968.1482445296874, 0.0005316073453201912, 0.0004173823679885906, 0.00041787211236231234, 0.0005316599359418265, 0.00041738125000003145, 0.00041812349908530597, 0.00041781357284951956, 0.00041812422440733063, 0.014009151332712173, 0.04256387399945259, 0.00041738379335374984, 0.27838352295074464, 0.0006216993657205253, 0.0006214997862031683, 0.10695584090862274, 0.18896469446334838, 0.00041738125799086753, 0.0004173812501248192, 0.00041738125000056244, 3.6410502490631105, 0.0004173812500000005, 0.0004173812500000338, 0.4368222353092194, 239.54286733242188, 3279.451833396875, 657.5629784164063, 3028.712819725, 0.00687699132103324, 0.00043241378679402407, 0.000457573305166699, 0.006843718890732527, 0.000457573305166699, 0.0004763561933856923, 0.00045460902182701976, 0.00046050054660616444, 0.00594722219247222, 0.14062149795207976, 0.000427846802804817, 0.08399686934862137, 0.0007672945081055164, 0.0005429592580100521, 0.03721635761175156, 0.061837047063446046, 0.0004228189414704335, 0.0004242900973537704, 0.0004259572011421202, 11.565237670861816, 0.0004173812500048076, 0.0004173812504744071, 0.1913994994989395, 236.05011525722657, 262.9099632796875, 458.4114281234375, 647.4211937484375, 0.0028585032137840986, 0.0004174146603589239, 0.0004557436746751424, 0.002858110894149542, 0.0004174174151721903, 0.0004746191057990305, 0.00044706164734696505, 0.00047467493058382535, 0.002100405241063237, 0.04824704649362564, 0.00042181435045739055, 0.2682436105838776, 0.0006362893487591296, 0.0006360783750921487, 0.10432254495534897, 0.18190063508663176, 0.00041739226129054605, 0.0004174434433367029, 0.0004173817686567287, 39.852483421289065, 0.0004173812500013208, 0.000417381250039722, 2.154986291848755, 955.0856834945313, 4367.365163475, 4932.33537831875, 2425.62932363125, 0.0004453006873433711, 0.0004173815183241407, 0.0004182624415677143, 0.0004452917597433785, 0.00041738125000000825, 0.0004186054272537891, 0.00041807630949795713, 0.0004186066240351298, 0.01693761134955883, 0.043310697846746446, 0.00041738235871067883, 0.2046562281480789, 0.0006083562344344332, 0.0006081699990233406, 0.07807243587884903, 0.13817946585330962, 0.00041738125022135864, 0.00041738125000168443, 0.000417381250000001, 9.533456474267577, 0.00041738125000000023, 0.00041738125000002473, 6.762825160943604, 3919.158376365625, 9738.34612050625, 8960.34612050625, 17514.30119863125, 0.0031096841717869043, 0.00042367903787697434, 0.0005135520492246374, 0.0031104003588467836, 0.0005135520492246374, 0.0005318573617757298, 0.000505977559069544, 0.0004531082828095183, 0.027029094942545892, 0.23664435716781615, 0.0004185528251497832, 0.10105145695123673, 0.00114392607210055, 0.0005708533149942755, 0.05719331996951103, 0.08176118107948303, 0.0004174117842275908, 0.0004173862213841932, 0.0004173816734106954, 48.954831748925784, 0.00041738125000166925, 0.0004173812503751551, 0.0728682798377037, 72.05706563564453, 2594.61955800625, 4665.7489525375, 6821.21233144375, 0.03285340937290192, 0.000417539973395316, 0.0007300856392163783, 0.03285241472039223, 0.00041764777975293474, 0.0011479930413685739, 0.0005859764511030167, 0.0011487038151159882, 0.0030607911336034536, 0.1652735468975067, 0.001724449409803748, 0.48778712721977235, 0.0007826303641110658, 0.0007822788771506398, 0.07981111826810837, 0.2384157178035736, 0.0006537408931678161, 0.0514015925160408, 0.026438446440434457, 181.39819875332032, 0.00041738125032357327, 0.00041738126271053316, 1.1806296405426024, 317.8560387191406, 95.2494637069336, 552.74260488125, 116.59271016689453, 0.000867062788157165, 0.0004173824841034861, 0.00041984820731220826, 0.0008669668619319796, 0.0004173812500001433, 0.00042145838514505305, 0.00041923622788152135, 0.00042146236736760476, 0.03399905162367821, 0.23556987913761138, 0.00041740034807956225, 0.827383249723053, 0.0009616313778594136, 0.0009611000001229345, 0.23400428863677977, 0.5028929409614563, 0.0004173813242788886, 0.0004173812549355459, 0.0004173812501148739, 15.709504753076171, 0.0004173812500000012, 0.0004173812500000306, 1.1990539130798339, 468.24318471523435, 15425.20842519375, 1575.7821556625, 7234.4188744125, 0.011252222307658195, 0.0004401274814796867, 0.001187602947166562, 0.011239217319226264, 0.001187602947166562, 0.0018786034357532858, 0.0009084052449822425, 0.0012017617278531193, 0.006236923117822409, 0.10951285036716461, 0.0019429564286753535, 0.11230453821334839, 0.0009194502650558948, 0.0006914671845067292, 0.023835416608190538, 0.06250979723844528, 0.004838389535135031, 0.03284858512196541, 0.194356590234375, 822.0155541, 0.00041738125071584206, 0.0004173813127369129, 0.018132507526016237, 14.383953720056152, 59.88319554897461, 376.8088280257812, 392.8887840804687, 0.04090286763820648, 0.0004174008816101153, 0.0004836751773752272, 0.04090180220518112, 0.0004174334757046498, 0.0007384123033177107, 0.00044562126603585203, 0.0007387276724245399, 0.03293931829247475, 23.972751289331054, 0.0004652487164918799, 5.638218551599121, 0.004751454298084975, 0.004747163229322434, 0.8142015633216858, 3.1004754600158693, 0.0004190243001545983, 0.0005622622862489894, 0.0004331701598773012, 21.37053456875, 0.00041738125002189954, 0.00041738125010586395, 0.4590297338596344, 80.48742452236328, 3624.922536521875, 6563.037038475, 2719.139821678125, 0.0006512124833449721, 0.0004173818477306983, 0.00041833064667860673, 0.0006512629784908145, 0.0004173812500000102, 0.00041918359121671675, 0.00041806463306391526, 0.0004191853526805804, 0.07866156818780899, 0.5257154402366638, 0.0004173839586524135, 1.2448839244476317, 0.0010876395550355315, 0.001086985359134525, 0.4246935543647766, 0.8226904568305969, 0.00041738125515098425, 0.00041738125009132393, 0.0004173812500009703, 8.601599365197753, 0.00041738125000000034, 0.0004173812500000144, 5.282457500421143, 2624.799977928125, 26921.23479238125, 14689.09319081875, 38208.28557363125, 0.039051707558965684, 0.00042029859158963665, 0.0005810304442917928, 0.038991685681676866, 0.0005810304442917928, 0.001059442308897525, 0.000499755298361089, 0.0009716839573144912, 0.23298668833885192, 32.3509041366211, 0.0005138888314747251, 1.9282018241516112, 0.006389129631853104, 0.0038830586286991834, 0.396013825856781, 1.2330429849258422, 0.0005603743935268372, 0.0007713569080721587, 0.0013748188663072884, 35.466611534082034, 0.0004173812500698701, 0.0004173812517236848, 6.455708175622559, 5547.38908925625, 1852.4999291, 5786.4999291, 7419.6532494125, 0.22722098203811644, 0.00041739474649636496, 0.0013227894247308373, 0.22721777828845977, 0.00041742793990172264, 0.0033908232158780098, 0.000871882760830596, 0.0033937319691091775, 0.05156777399096489, 22.107471137963866, 0.0007496284248106181, 14.660833030664062, 0.019315670900678636, 0.019297023960089685, 1.9257632789245605, 7.379393726312256, 0.0004262917878719978, 0.0008760834621995687, 0.0006185357065903022, 409.4749352035156, 0.0004173812500805561, 0.00041738125121443546, 1.7463889417282104, 551.5056664046875, 108085.00822988125, 38444.56291738125, 56558.80901113125, 0.0014923647555321455, 0.0004173816950940172, 0.0004261119380232063, 0.001492153228892386, 0.00041738125000000706, 0.000436318474012916, 0.0004228482281093253, 0.00043633698223009707, 0.03834361555490494, 0.9411226806274414, 0.0004174237217150338, 2.098181158029175, 0.002077192375136912, 0.0020755702440425753, 0.6182982024780274, 1.3130560216537475, 0.00041738125962821404, 0.0004173812524338771, 0.00041738125000382036, 62.52564778896485, 0.0004173812500000083, 0.00041738125000019007, 3.297494321786499, 1616.206716209375, 23573.44768300625, 40905.73088613125, 62300.60197988125, 0.2681929764381409, 0.00042254704848408584, 0.0026546471795797348, 0.2681275901428223, 0.0026546471795797348, 0.006364248417949677, 0.0017637764845773577, 0.004721577004230023, 0.8382362422576904, 29.83834233852539, 0.0008640134343210607, 5.805385261499024, 0.03816719325695038, 0.015669707865154744, 1.1072547731033324, 3.4821340140930177, 0.0008298335756905376, 0.001368518876543641, 0.0029791891152769327, 386.9507652816406, 0.0004173812501657119, 0.000417381265266061, 4.246661334954834, 4561.626882225, 24681.78557363125, 33045.72307363125, 54459.69572988125, 0.0019418349998801946, 0.0004173931233485266, 0.00042966374584528386, 0.0019419545584157109, 0.00041741946564931173, 0.00043680610869221856, 0.00042711797831605655, 0.0004368251589682419, 0.004869577199852467, 0.05690389471564293, 0.00041818315551443594, 0.2721081373325348, 0.0005774393226517364, 0.0005772713498942554, 0.10855890782985687, 0.18713144930515288, 0.0004173855420040855, 0.0004173876113798673, 0.0004173812952854525, 22.55429807277832, 0.00041738125000024645, 0.0004173812500098751, 4.029542118035889, 1881.0718285140624, 9332.36272206875, 6762.6337181625, 4892.28362050625, 0.0004440638618604513, 0.00041738168470416157, 0.0004178618049451703, 0.00044405993648131845, 0.00041738125000000375, 0.00041812655771598803, 0.0004177614649706189, 0.0004181272864486178, 0.021078385137653352, 0.04999791430745125, 0.00041738202350265083, 0.19406941505584716, 0.0007431171703416854, 0.0007427989490594714, 0.07094999375257492, 0.1281658408275604, 0.0004173812503872982, 0.0004173812500020643, 0.00041738125000000185, 4.964109092675781, 0.0004173812500000002, 0.0004173812500000176, 1.46347513767395, 1244.0183617171874, 1724.8505150375, 2710.80510488125, 3673.857595115625, 0.001987070850728452, 0.0004212362374261662, 0.00044594671961993446, 0.0019774472617343068, 0.00044594671961993446, 0.00045623062541442924, 0.00044239122834431474, 0.00043286684339425993, 0.029113219775891305, 0.3508918878665924, 0.0004176736771598204, 0.09189346405181885, 0.0008372371827051043, 0.0005095477768833749, 0.05355870323691368, 0.07601395221862793, 0.0004173937535395371, 0.0004173831651253916, 0.00041738150974439267, 27.49829450222168, 0.0004173812500003372, 0.0004173812500706062, 0.01235776925895214, 11.270011573754882, 4570.0751244125, 4703.29143300625, 8419.32658925625, 0.17415721686992644, 0.00041756279617009715, 0.001009510904251039, 0.17412932189617156, 0.0004177632817147074, 0.0016133256300151348, 0.0008199455201890319, 0.0016144935085237026, 0.004307680022603274, 1.7133406695953368, 0.001739840097425878, 1.968303590737915, 0.0013423456271909177, 0.0013414546425253152, 0.44444882842216493, 1.131664424859619, 0.0006113385039413347, 0.03494993197236061, 0.04289794685754776, 132.815114646875, 0.00041738125020671644, 0.00041738125284205256, 0.7482767400375366, 235.57039418789063, 532.2251488265625, 1551.1797386703124, 254.06607595058594, 0.0008860805406499654, 0.00041738340772377744, 0.0004201920242764405, 0.0008861182883180677, 0.00041738125000006355, 0.00042208142948828173, 0.0004195213456029538, 0.0004220860233460204, 0.035388145320749284, 0.10227865698251724, 0.00041742184093328125, 0.4883392450443268, 0.000643590917744115, 0.0006433701069824397, 0.16476549180660247, 0.3147555288902283, 0.0004173816309374205, 0.0004173812685483174, 0.00041738125041289277, 13.146995216333007, 0.00041738125000000565, 0.0004173812500001724, 1.6009047326675414, 1510.444020896875, 5263.232350975, 1976.678395896875, 6717.96330800625, 0.1669648286930084, 0.00044768678671123927, 0.0018278400690093636, 0.1663891521326065, 0.0018278400690093636, 0.0028092800217479467, 0.0015272174074113369, 0.001619982258117199, 0.05558356615219116, 2.486092477761841, 0.001520923762282729, 0.546396225415802, 0.0016044820236772298, 0.0009122457864493131, 0.1767125424972534, 0.3678824898830414, 0.004220856078600884, 0.031300918855404855, 0.23313972326431273, 788.09807363125, 0.0004173812504878796, 0.0004173812870696911, 1.7497092780700683, 1859.4500023421874, 466.8102928695312, 1420.9956566390624, 1837.1836449203124, 0.048546138875818254, 0.0004174109405859898, 0.00094007411243245, 0.048544879727697374, 0.0004174124977332898, 0.0015760021793454885, 0.0007356160072874277, 0.0015771347840115428, 0.003465538103765249, 0.8989553746810913, 0.0005750841388277709, 1.2365564403167724, 0.0016118756771817803, 0.001610702676399052, 0.31790888281974794, 0.7416879829994202, 0.00041742126951836586, 0.000478020979781542, 0.0004176855819622975, 208.34920278164063, 0.0004173812500297202, 0.00041738125062133616, 1.8745812472930907, 838.8191429671875, 4543.74358144375, 10424.37346425625, 1930.06291738125, 0.0004911377924060449, 0.0004173816764389397, 0.00041833970996384015, 0.0004911374940917827, 0.0004173812500000056, 0.0004189104276662707, 0.00041809667677915205, 0.00041891192321662094, 0.020844792672133447, 0.08825102420959473, 0.0004173826769841975, 0.4596965906253815, 0.0007597101663038134, 0.0007593755595650523, 0.17327333959255217, 0.3104685244194031, 0.0004173812502489731, 0.0004173812500039778, 0.00041738125000000185, 10.023395210229491, 0.0004173812500000003, 0.00041738125000002235, 7.337471157037354, 4395.0204369125, 34457.32463613125, 17496.36565175625, 47739.95744863125, 0.05364348711881638, 0.0004226164865855768, 0.0017030011673256754, 0.053423959486818315, 0.0017030011673256754, 0.002734621944537759, 0.0013529481526263058, 0.0015299171951398253, 0.11601818325433731, 2.5178221759429933, 0.0005221504412390291, 0.44041079255256654, 0.0036129813684880733, 0.0013821775370076298, 0.15957559617671965, 0.31245347829971315, 0.0004502231327848509, 0.0004544872986941133, 0.00045822026512785816, 153.50687184902344, 0.00041738125004673135, 0.0004173812542472432, 0.5606020388237, 572.1326805648438, 3851.173513084375, 9388.47990956875, 12853.10002675625, 0.6249392923942566, 0.00041743215977595047, 0.0014809954023718833, 0.6249262985816956, 0.00041779760610159575, 0.005507989511525631, 0.0007904702375441789, 0.005512958117461205, 0.09489390226516724, 27.101611762963866, 0.007567485519385338, 15.900400787316894, 0.010133227989709377, 0.010123741537964344, 0.9824226793876648, 6.111564308129883, 0.004090783144047857, 2.273819833718872, 2.5486811694732667, 886.2078148421875, 0.0004173812517390591, 0.0004173812646003036, 0.5518797335258484, 89.76547780605469, 20715.90862050625, 5516.6180931625, 16464.58635488125, 0.0021014206155002117, 0.0004173828026800956, 0.0004261015115759452, 0.0021013280653193593, 0.0004173812500001403, 0.0004371966639070539, 0.0004232141023664386, 0.00043721603068723344, 0.10407596053991318, 3.246489673577881, 0.0004176269486578636, 2.150645881616211, 0.0025887321258693933, 0.0025866117371976375, 0.4343439337841034, 1.1873209771743773, 0.0004173866059716662, 0.0004173828854949617, 0.0004173814908149791, 34.00789418789063, 0.00041738125000005785, 0.0004173812500013584, 6.28618922802124, 4889.72307363125, 10936.08733144375, 10019.16643300625, 19610.98283925625, 0.7240299281707764, 0.00042812671617019224, 0.0030486462215691804, 0.7232576307884216, 0.0030486462215691804, 0.010598590322470665, 0.0015250974844008684, 0.008714914978182315, 0.22959434958610533, 20.729196220361327, 0.01651077876303196, 6.358577877008057, 0.011446462669110298, 0.008006974314039945, 0.5201595720878601, 2.834073215447998, 0.26015651198539735, 7.236877113305664, 219.72926869960938, 3687.65569081875, 0.00041738125550606003, 0.00041738141891346656, 2.1146737632385255, 1337.5720726546874, 1417.1807152328124, 3158.704763084375, 4308.759694725};

const float32_t classPriors [NB_OF_CLASSES] = {
0.09549356223175966, 0.0971030042918455, 0.09495708154506438, 0.10139484978540772, 0.10407725321888411, 0.10085836909871244, 0.10354077253218884, 0.10085836909871244, 0.09978540772532189, 0.10193133047210301};

float32_t epsilon = 0.00041738125;

/**
 * @brief Carry out standardized calculation
 * 
 * @param scaler Example of the standardizer
 * @param input Input feature matrix
 * @param output Output feature matrix
 */
/*
float32_t *scaler_transform(const float32_t *input)
{
	static float32_t std_scaler_feature_matrix[81];
	float32_t mean, std;
	//float32_t epsilon = 1e-7; //zero protection against elimination
	arm_mean_f32(&input[0], 81, &mean); //mean value
	arm_std_f32(&input[0], 81, &std); //standard deviation

	for(uint8_t i = 0; i < 81; i++) {
		std_scaler_feature_matrix[i] = (input[i] - mean) / std;
  }
	return std_scaler_feature_matrix;
}
*/

/**
 * @brief GAUSSIAN_DB prediction
 * 
 * @param arm_gaussian_db_predict_f32
 * @param input
 * @param output
 */

uint32_t arm_gaussian_db_predict_f32(const float32_t * in) // ADD kernel function decision value
{
	float32_t buffer[NB_OF_CLASSES];
	float32_t output_prob[NB_OF_CLASSES];
	float32_t result;
	uint32_t index;
	arm_gaussian_naive_bayes_instance_f32 S; 
	S.vectorDimension = VECTOR_DIMENSION; 
	S.numberOfClasses = NB_OF_CLASSES; 
	S.theta = theta;          
	S.sigma = sigma;         
	S.classPriors = classPriors;    
	S.epsilon = epsilon;

	arm_gaussian_naive_bayes_predict_f32(&S, in, output_prob, buffer); 

	arm_max_f32(output_prob, NB_OF_CLASSES, &result, &index); 
	
	return index;
}
